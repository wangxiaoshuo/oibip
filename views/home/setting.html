<head>
    <meta charset="UTF-8">
    <title>个人资料</title>
    <link rel="stylesheet" href="/css/setting.css">
    <style>
        .username_note,.sex{
            color: #aaa;
            margin-left: 33px;
            height: 38px;
            display: block;
            float: left;
            line-height: 38px;
        }
        .city select{
            height: 30px;
           border-color: #D2D2D2!important;
            color: #99a2aa;
            border-radius: 2px;
        }
        .save_1,.save_2{
            width: 110px;
            height: 36px;
            margin-left: 31%;
            margin-top: 40px;
        }
        .sex_note{color: lightcoral;text-decoration: underline;}
        .sex_note:hover{color:tomato}
        .cc{
            overflow: hidden;
            width: 980px;
            height: 100%;
            margin: 10px auto 100px;
            box-shadow: 0 2px 4px rgba(0,0,0,.14);
            background: #fafafa;
            border-radius: 4px;
            border:1px solid #ccc;
        }
        .am-radio{
            display: inline-block;
            width:44px;
        }
        .sex_change{margin-left:80px;}

    </style>
</head>
<div class="cc">
    <div class="left">
        <ul>
            <li style="border-bottom: 1px solid #e1e2e5;height:60px;">
                <a href="/site/setting.html">
                    <i><img src="/images/zhuye.png" alt="" width="20px" height="20px"></i><span>主页</span>
                </a>
            </li>
            <li>
                <a href="/site/setting.html" class="select">
                    <i><img src="/images/wszl.png" alt="" width="20px" height="20px"></i><span>个人资料</span>
                </a>
            </li>
            <li>
                <a href="/site/tx.html">
                    <i><img src="/images/tx.png" alt="" width="20px" height="20px"></i><span>我的头像</span>
                </a>
            </li>
            <li>
                <a href="/site/sc.html">
                    <i><img src="/images/sc.png" alt="" width="20px" height="20px"></i><span>我的收藏</span>
                </a>
            </li>
            <li>
                <a href="/site/fb.html">
                    <i><img src="/images/fb.png" alt="" width="20px" height="20px"></i><span>发布作品</span>
                </a>
            </li>
            <li>
                <a href="/site/safe.html">
                    <i><img src="/images/safe.png" alt="" width="20px" height="20px"></i><span>账号安全</span>
                </a>
            </li>
        </ul>
    </div>
    <div class="right">
        <div class="r_top">
            <ol class="am-breadcrumb">
                <li style="margin-left:20px;"><a href="#">主页</a></li>
                <li class="am-active">个人资料</li>
            </ol>
        </div>
        <div class="right_content">
            <div class="basic">
                <div class="layui-form-item">
                    <label class="layui-form-label">昵称：</label>
                    <div class="layui-input-block" style="float:left;margin-left:0px">
                        <input type="text" name="title" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input nickname" value={{nickname}} style="border-radius: 5px;width:225px;">
                    </div>
                    <span class="username_note">注：修改修改个性的昵称</span>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">性别：</label>
                    <div class="sex_change">
                        <div class="am-radio">
                            <label>
                                <span>男</span> <input type="radio" name="doc-radio-1" value="0" checked="checked">
                            </label>
                        </div>
                        <div class="am-radio" style="margin-top:7px;">
                            <label>
                                <span>女</span> <input type="radio" name="doc-radio-1" value="1">
                            </label>
                        </div>
                    </div>

                </div>
                <div class="layui-form-item layui-form-text">
                    <label class="layui-form-label">我的签名：</label>
                    <div class="layui-input-block">
                        <textarea placeholder="设置您的签名" class="layui-textarea qm" style="width:618px">{{qm}}</textarea>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">出生日期：</label>
                    <div class="layui-input-block">
                        <input type="text" name="date" id="date1" autocomplete="off" class="layui-input born_at" value={{born_at}} style="width:190px">
                    </div>
                </div>
                <div class="layui-input-inline city job_city">
                    <label class="layui-form-label">所在城市：</label>
                    <div class="layui-input-inline job_city_selected" data-toggle="distpicker">

                    </div>
                </div><div class="clear"></div>
                <button class="layui-btn save_1">保存</button>
            </div>
        </div>

    </div>
</div>
<div hid class="username">{{username}}</div>
<div hid class="job_city_province">{{job_city_province}}</div>
<div hid class="job_city_city">{{job_city_city}}</div>
<div hid class="job_city_area">{{job_city_area}}</div>
<div hid class="sex_v">{{sex}}</div>
<script type="text/javascript" src="/js/lay/laydate.js"></script>
<script>
    layui.use('laydate', function() {
        var laydate = layui.laydate;

        laydate.render({
            elem: '#date'
        });
        laydate.render({
            elem: '#date1'
        });
    })
    if($(".sex_v").text() == 1){
      $(".sex_change input[value=\"1\"]").attr("checked","checked")
      $(".sex_change input[value=\"0\"]").removeAttr("checked")
    }else{
        $(".sex_change input[value=\"1\"]").removeAttr("checked")
        $(".sex_change input[value=\"0\"]").attr("checked","checked")
    }

    $(".sex_change input[value=\"1\"]").on("click",function () {
        $(".sex_change input[value=\"1\"]").attr("checked","checked")
        $(".sex_change input[value=\"0\"]").removeAttr("checked")
    })

    $(".sex_change input[value=\"0\"]").on("click",function () {
        $(".sex_change input[value=\"1\"]").removeAttr("checked")
        $(".sex_change input[value=\"0\"]").attr("checked","checked")
    })

    var aa = $(".job_city_city").text()
    console.log(aa)
    $(".job_city_selected").html(
        '<select data-province='+$(".job_city_province").text()+' class="p"></select>'+
        '<select data-city='+aa+' class="c"></select>'+
        '<select data-district='+$(".job_city_area").text()+' class="a"></select>')
    $(function(){
        console.log($(".job_city_city").text())
        $(".job_city .p").attr('data-province',$(".job_city_province").text())
        $(".job_city .c").val($(".job_city_city").text())
        $(".job_city .a").val($(".job_city_area").text())
        $(".save_1").on("click",function () {
            var nickname = $(".nickname").val()
            var username = $(".username").text()
            var qm = $(".qm").val()
            var sex = $(".sex_change input:checked").val()
            console.log("sex",sex)
            var born_at = $(".born_at").val()
            var job_city_province = $(".job_city .p").val()
            var job_city_city = $(".job_city .c").val()
            var job_city_area = $(".job_city .a").val()
            if(!nickname || !qm || !born_at || !job_city_province || !job_city_city || !job_city_area){
                layer.msg("请完善资料后保存！")
            }else{
                $.ajax({
                    url:"/user/cost/update",
                    type:"post",
                    data:{nickname:nickname,qm:qm,sex:sex,born_at:born_at,job_city_province:job_city_province,job_city_city:job_city_city,job_city_area:job_city_area},
                    success:function (res) {
                        if(res == true){
                            layer.msg("保存成功！")
                            setTimeout(function(){
                                window.location.reload()
                            },500)
                        }
                    },
                    error:function(err){
                        layer.msg("服务器繁忙，稍后再试！")
                    }
                })
            }
        })
    })
</script>
<script type="text/javascript" src="/js/distpicker.min.js"></script>

